(function(){var $;($=jQuery).fn.extend({prettyTextDiff:function(options){var dmp,settings;return settings={originalContainer:".original",changedContainer:".changed",diffContainer:".diff",cleanup:!0,debug:!1},settings=$.extend(settings,options),$.fn.prettyTextDiff.debug("Options: ",settings,settings),dmp=new diff_match_patch,this.each(function(){var changed,diff_as_html,diffs,original;return settings.originalContent&&settings.changedContent?(original=$("<div />").html(settings.originalContent).text(),changed=$("<div />").html(settings.changedContent).text()):(original=$(settings.originalContainer,this).text(),changed=$(settings.changedContainer,this).text()),$.fn.prettyTextDiff.debug("Original text found: ",original,settings),$.fn.prettyTextDiff.debug("Changed  text found: ",changed,settings),diffs=dmp.diff_main(original,changed),settings.cleanup&&dmp.diff_cleanupSemantic(diffs),$.fn.prettyTextDiff.debug("Diffs: ",diffs,settings),diff_as_html=$.map(diffs,function(diff){return $.fn.prettyTextDiff.createHTML(diff)}),$(settings.diffContainer,this).html(diff_as_html.join("")),this})}}),$.fn.prettyTextDiff.debug=function(message,object,settings){if(settings.debug)return console.log(message,object)},$.fn.prettyTextDiff.createHTML=function(diff){var operation,pattern_amp,pattern_gt,pattern_lt,pattern_para,text;switch([],pattern_amp=/&/g,pattern_lt=/</g,pattern_gt=/>/g,pattern_para=/\n/g,operation=diff[0],text=diff[1].replace(pattern_amp,"&amp;").replace(pattern_lt,"&lt;").replace(pattern_gt,"&gt;").replace(pattern_para,"<br>"),operation){case DIFF_INSERT:return"<ins>"+text+"</ins>";case DIFF_DELETE:return"<del>"+text+"</del>";case DIFF_EQUAL:return"<span>"+text+"</span>"}}}).call(this);