!function(m){var p,q,r,o={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},v={check:{enable:!1,autoCheckTrigger:!1,chkStyle:o.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:o.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}};p=function(c,a){if(!0===a.chkDisabled)return!1;var b=g.getSetting(c.data.treeId),d=b.data.key.checked;return 0==k.apply(b.callback.beforeCheck,[b.treeId,a],!0)||(a[d]=!a[d],e.checkNodeRelation(b,a),d=n(a,j.id.CHECK,b),e.setChkClass(b,d,a),e.repairParentChkClassWithSelf(b,a),b.treeObj.trigger(j.event.CHECK,[c,b.treeId,a]),!0)},q=function(c,a){if(!0===a.chkDisabled)return!1;var b=g.getSetting(c.data.treeId),d=n(a,j.id.CHECK,b);return a.check_Focus=!0,e.setChkClass(b,d,a),!0},r=function(c,a){if(!0===a.chkDisabled)return!1;var b=g.getSetting(c.data.treeId),d=n(a,j.id.CHECK,b);return a.check_Focus=!1,e.setChkClass(b,d,a),!0},m.extend(!0,m.fn.zTree.consts,o),m.extend(!0,m.fn.zTree._z,{tools:{},view:{checkNodeRelation:function(c,a){var b,d,h,i=c.data.key.children,l=c.data.key.checked;if(b=j.radio,c.check.chkStyle==b.STYLE){var f=g.getRadioCheckedList(c);if(a[l])if(c.check.radioType==b.TYPE_ALL){for(d=f.length-1;d>=0;d--)(b=f[d])[l]&&b!=a&&(b[l]=!1,f.splice(d,1),e.setChkClass(c,n(b,j.id.CHECK,c),b),b.parentTId!=a.parentTId&&e.repairParentChkClassWithSelf(c,b));f.push(a)}else for(d=0,h=(f=a.parentTId?a.getParentNode():g.getRoot(c))[i].length;d<h;d++)(b=f[i][d])[l]&&b!=a&&(b[l]=!1,e.setChkClass(c,n(b,j.id.CHECK,c),b));else if(c.check.radioType==b.TYPE_ALL)for(d=0,h=f.length;d<h;d++)if(a==f[d]){f.splice(d,1);break}}else a[l]&&(!a[i]||0==a[i].length||c.check.chkboxType.Y.indexOf("s")>-1)&&e.setSonNodeCheckBox(c,a,!0),!a[l]&&(!a[i]||0==a[i].length||c.check.chkboxType.N.indexOf("s")>-1)&&e.setSonNodeCheckBox(c,a,!1),a[l]&&c.check.chkboxType.Y.indexOf("p")>-1&&e.setParentNodeCheckBox(c,a,!0),!a[l]&&c.check.chkboxType.N.indexOf("p")>-1&&e.setParentNodeCheckBox(c,a,!1)},makeChkClass:function(c,a){var b=c.data.key.checked,d=j.checkbox,h=j.radio,i=!0===a.chkDisabled?d.DISABLED:a.halfCheck?d.PART:c.check.chkStyle==h.STYLE?a.check_Child_State<1?d.FULL:d.PART:a[b]?2===a.check_Child_State||-1===a.check_Child_State?d.FULL:d.PART:a.check_Child_State<1?d.FULL:d.PART;b=c.check.chkStyle+"_"+(a[b]?d.TRUE:d.FALSE)+"_"+i,b=a.check_Focus&&!0!==a.chkDisabled?b+"_"+d.FOCUS:b;return j.className.BUTTON+" "+d.DEFAULT+" "+b},repairAllChk:function(c,a){if(c.check.enable&&c.check.chkStyle===j.checkbox.STYLE)for(var b=c.data.key.checked,d=c.data.key.children,h=g.getRoot(c),i=0,l=h[d].length;i<l;i++){var f=h[d][i];!0!==f.nocheck&&!0!==f.chkDisabled&&(f[b]=a),e.setSonNodeCheckBox(c,f,a)}},repairChkClass:function(c,a){if(a&&(g.makeChkFlag(c,a),!0!==a.nocheck)){var b=n(a,j.id.CHECK,c);e.setChkClass(c,b,a)}},repairParentChkClass:function(c,a){if(a&&a.parentTId){var b=a.getParentNode();e.repairChkClass(c,b),e.repairParentChkClass(c,b)}},repairParentChkClassWithSelf:function(c,a){if(a){var b=c.data.key.children;a[b]&&a[b].length>0?e.repairParentChkClass(c,a[b][0]):e.repairParentChkClass(c,a)}},repairSonChkDisabled:function(c,a,b,d){if(a){var h=c.data.key.children;if(a.chkDisabled!=b&&(a.chkDisabled=b),e.repairChkClass(c,a),a[h]&&d)for(var i=0,l=a[h].length;i<l;i++)e.repairSonChkDisabled(c,a[h][i],b,d)}},repairParentChkDisabled:function(c,a,b,d){a&&(a.chkDisabled!=b&&d&&(a.chkDisabled=b),e.repairChkClass(c,a),e.repairParentChkDisabled(c,a.getParentNode(),b,d))},setChkClass:function(c,a,b){a&&(!0===b.nocheck?a.hide():a.show(),a.attr("class",e.makeChkClass(c,b)))},setParentNodeCheckBox:function(c,a,b,d){var h=c.data.key.children,i=c.data.key.checked,l=n(a,j.id.CHECK,c);if(d||(d=a),g.makeChkFlag(c,a),!0!==a.nocheck&&!0!==a.chkDisabled&&(a[i]=b,e.setChkClass(c,l,a),c.check.autoCheckTrigger&&a!=d&&c.treeObj.trigger(j.event.CHECK,[null,c.treeId,a])),a.parentTId){if(l=!0,!b)for(var f=0,k=(h=a.getParentNode()[h]).length;f<k;f++)if(!0!==h[f].nocheck&&!0!==h[f].chkDisabled&&h[f][i]||(!0===h[f].nocheck||!0===h[f].chkDisabled)&&h[f].check_Child_State>0){l=!1;break}l&&e.setParentNodeCheckBox(c,a.getParentNode(),b,d)}},setSonNodeCheckBox:function(c,a,b,d){if(a){var h=c.data.key.children,i=c.data.key.checked,l=n(a,j.id.CHECK,c);d||(d=a);var f=!1;if(a[h])for(var k=0,m=a[h].length;k<m;k++){var o=a[h][k];e.setSonNodeCheckBox(c,o,b,d),!0===o.chkDisabled&&(f=!0)}a!=g.getRoot(c)&&!0!==a.chkDisabled&&(f&&!0!==a.nocheck&&g.makeChkFlag(c,a),!0!==a.nocheck&&!0!==a.chkDisabled?(a[i]=b,f||(a.check_Child_State=a[h]&&a[h].length>0?b?2:0:-1)):a.check_Child_State=-1,e.setChkClass(c,l,a),c.check.autoCheckTrigger&&a!=d&&!0!==a.nocheck&&!0!==a.chkDisabled&&c.treeObj.trigger(j.event.CHECK,[null,c.treeId,a]))}}},event:{},data:{getRadioCheckedList:function(c){for(var a=g.getRoot(c).radioCheckedList,b=0,d=a.length;b<d;b++)g.getNodeCache(c,a[b].tId)||(a.splice(b,1),b--,d--);return a},getCheckStatus:function(c,a){if(!c.check.enable||a.nocheck||a.chkDisabled)return null;var b=c.data.key.checked;return{checked:a[b],half:a.halfCheck?a.halfCheck:c.check.chkStyle==j.radio.STYLE?2===a.check_Child_State:a[b]?a.check_Child_State>-1&&a.check_Child_State<2:a.check_Child_State>0}},getTreeCheckedNodes:function(c,a,b,d){if(!a)return[];for(var h=c.data.key.children,i=c.data.key.checked,e=b&&c.check.chkStyle==j.radio.STYLE&&c.check.radioType==j.radio.TYPE_ALL,f=(d=d||[],0),k=a.length;f<k&&(!0===a[f].nocheck||!0===a[f].chkDisabled||a[f][i]!=b||(d.push(a[f]),!e))&&(g.getTreeCheckedNodes(c,a[f][h],b,d),!(e&&d.length>0));f++);return d},getTreeChangeCheckedNodes:function(c,a,b){if(!a)return[];for(var d=c.data.key.children,h=c.data.key.checked,i=(b=b||[],0),e=a.length;i<e;i++)!0!==a[i].nocheck&&!0!==a[i].chkDisabled&&a[i][h]!=a[i].checkedOld&&b.push(a[i]),g.getTreeChangeCheckedNodes(c,a[i][d],b);return b},makeChkFlag:function(c,a){if(a){var b=c.data.key.children,d=c.data.key.checked,h=-1;if(a[b])for(var i=0,e=a[b].length;i<e;i++){var f=a[b][i],g=-1;if(c.check.chkStyle==j.radio.STYLE){if(2==(g=!0===f.nocheck||!0===f.chkDisabled?f.check_Child_State:!0===f.halfCheck?2:f[d]?2:f.check_Child_State>0?2:0)){h=2;break}0==g&&(h=0)}else if(c.check.chkStyle==j.checkbox.STYLE){if(1===(g=!0===f.nocheck||!0===f.chkDisabled?f.check_Child_State:!0===f.halfCheck?1:f[d]?-1===f.check_Child_State||2===f.check_Child_State?2:1:f.check_Child_State>0?1:0)){h=1;break}if(2===g&&h>-1&&i>0&&g!==h){h=1;break}if(2===h&&g>-1&&g<2){h=1;break}g>-1&&(h=g)}}a.check_Child_State=h}}}});var k=(m=m.fn.zTree)._z.tools,j=m.consts,e=m._z.view,g=m._z.data,n=k.$;g.exSetting(v),g.addInitBind(function(c){c.treeObj.bind(j.event.CHECK,function(a,b,d,h){a.srcEvent=b,k.apply(c.callback.onCheck,[a,d,h])})}),g.addInitUnBind(function(c){c.treeObj.unbind(j.event.CHECK)}),g.addInitCache(function(){}),g.addInitNode(function(c,a,b,d){b&&(a=c.data.key.checked,"string"==typeof b[a]&&(b[a]=k.eqs(b[a],"true")),b[a]=!!b[a],b.checkedOld=b[a],"string"==typeof b.nocheck&&(b.nocheck=k.eqs(b.nocheck,"true")),b.nocheck=!!b.nocheck||c.check.nocheckInherit&&d&&!!d.nocheck,"string"==typeof b.chkDisabled&&(b.chkDisabled=k.eqs(b.chkDisabled,"true")),b.chkDisabled=!!b.chkDisabled||c.check.chkDisabledInherit&&d&&!!d.chkDisabled,"string"==typeof b.halfCheck&&(b.halfCheck=k.eqs(b.halfCheck,"true")),b.halfCheck=!!b.halfCheck,b.check_Child_State=-1,b.check_Focus=!1,b.getCheckStatus=function(){return g.getCheckStatus(c,b)},c.check.chkStyle==j.radio.STYLE&&c.check.radioType==j.radio.TYPE_ALL&&b[a]&&g.getRoot(c).radioCheckedList.push(b))}),g.addInitProxy(function(c){var a=c.target,b=g.getSetting(c.data.treeId),d="",h=null,e="",l=null;if(k.eqs(c.type,"mouseover")?b.check.enable&&k.eqs(a.tagName,"span")&&null!==a.getAttribute("treeNode"+j.id.CHECK)&&(d=k.getNodeMainDom(a).id,e="mouseoverCheck"):k.eqs(c.type,"mouseout")?b.check.enable&&k.eqs(a.tagName,"span")&&null!==a.getAttribute("treeNode"+j.id.CHECK)&&(d=k.getNodeMainDom(a).id,e="mouseoutCheck"):k.eqs(c.type,"click")&&b.check.enable&&k.eqs(a.tagName,"span")&&null!==a.getAttribute("treeNode"+j.id.CHECK)&&(d=k.getNodeMainDom(a).id,e="checkNode"),d.length>0)switch(h=g.getNodeCache(b,d),e){case"checkNode":l=p;break;case"mouseoverCheck":l=q;break;case"mouseoutCheck":l=r}return{stop:"checkNode"===e,node:h,nodeEventType:e,nodeEventCallback:l,treeEventType:"",treeEventCallback:null}},!0),g.addInitRoot(function(c){g.getRoot(c).radioCheckedList=[]}),g.addBeforeA(function(c,a,b){c.check.enable&&(g.makeChkFlag(c,a),b.push("<span ID='",a.tId,j.id.CHECK,"' class='",e.makeChkClass(c,a),"' treeNode",j.id.CHECK,!0===a.nocheck?" style='display:none;'":"","></span>"))}),g.addZTreeTools(function(c,a){a.checkNode=function(a,b,c,g){var f=this.setting.data.key.checked;!0===a.chkDisabled||(!0!==b&&!1!==b&&(b=!a[f]),g=!!g,a[f]===b&&!c||g&&0==k.apply(this.setting.callback.beforeCheck,[this.setting.treeId,a],!0)||!k.uCanDo(this.setting)||!this.setting.check.enable||!0===a.nocheck)||(a[f]=b,b=n(a,j.id.CHECK,this.setting),(c||this.setting.check.chkStyle===j.radio.STYLE)&&e.checkNodeRelation(this.setting,a),e.setChkClass(this.setting,b,a),e.repairParentChkClassWithSelf(this.setting,a),g&&this.setting.treeObj.trigger(j.event.CHECK,[null,this.setting.treeId,a]))},a.checkAllNodes=function(a){e.repairAllChk(this.setting,!!a)},a.getCheckedNodes=function(a){var b=this.setting.data.key.children;return g.getTreeCheckedNodes(this.setting,g.getRoot(this.setting)[b],!1!==a)},a.getChangeCheckedNodes=function(){var a=this.setting.data.key.children;return g.getTreeChangeCheckedNodes(this.setting,g.getRoot(this.setting)[a])},a.setChkDisabled=function(a,b,c,g){b=!!b,c=!!c,e.repairSonChkDisabled(this.setting,a,b,!!g),e.repairParentChkDisabled(this.setting,a.getParentNode(),b,c)};var b=a.updateNode;a.updateNode=function(c,g){if(b&&b.apply(a,arguments),c&&this.setting.check.enable&&n(c,this.setting).get(0)&&k.uCanDo(this.setting)){var i=n(c,j.id.CHECK,this.setting);(1==g||this.setting.check.chkStyle===j.radio.STYLE)&&e.checkNodeRelation(this.setting,c),e.setChkClass(this.setting,i,c),e.repairParentChkClassWithSelf(this.setting,c)}}});var s=e.createNodes;e.createNodes=function(c,a,b,d,g){s&&s.apply(e,arguments),b&&e.repairParentChkClassWithSelf(c,d)};var t=e.removeNode;e.removeNode=function(c,a){var b=a.getParentNode();t&&t.apply(e,arguments),a&&b&&(e.repairChkClass(c,b),e.repairParentChkClass(c,b))};var u=e.appendNodes;e.appendNodes=function(c,a,b,d,h,i,j){var f="";return u&&(f=u.apply(e,arguments)),d&&g.makeChkFlag(c,d),f}}(jQuery);